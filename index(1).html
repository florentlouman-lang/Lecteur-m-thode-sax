
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Lecteur Audio Avanc√©</title>

  <script src="https://unpkg.com/tone@latest/build/Tone.js"></script>

  <style>
    body {
      font-family: "Inter", Arial, sans-serif;
      background: linear-gradient(135deg, #262a35, #1b1e29);
      color: #fff;
      margin: 0;
      padding: 40px;
      display: flex;
      justify-content: center;
    }

    .player {
      background: #2f3442;
      padding: 30px;
      width: 450px;
      border-radius: 18px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.35);
    }

    h1 {
      text-align: center;
      margin-bottom: 25px;
      font-weight: 600;
      letter-spacing: 1px;
    }

    select, button {
      width: 100%;
      padding: 12px;
      border: none;
      border-radius: 10px;
      margin-top: 10px;
      font-size: 16px;
      background: #3c4150;
      color: #fff;
    }

    button {
      background: #5964ff;
      cursor: pointer;
      transition: 0.2s;
    }

    button:hover {
      background: #6c75ff;
    }

    .control-group {
      margin-top: 25px;
    }

    .label-row {
      display: flex;
      justify-content: space-between;
      font-size: 14px;
      opacity: 0.8;
      margin-bottom: 5px;
    }

    input[type=range] {
      width: 100%;
      -webkit-appearance: none;
      background: #444b5b;
      height: 6px;
      border-radius: 3px;
      outline: none;
    }

    input[type=range]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 16px;
      height: 16px;
      background: #5964ff;
      border-radius: 50%;
      cursor: pointer;
    }

    footer {
      margin-top: 20px;
      text-align: center;
      opacity: 0.6;
      font-size: 12px;
    }
  </style>
</head>

<body>
  <div class="player">
    <h1>üéß Lecteur Audio</h1>

    <label for="trackSelect">Choisir un morceau :</label>
    <select id="trackSelect">
      <option value="audio/morceau1.mp3">Morceau 1</option>
      <option value="audio/morceau2.mp3">Morceau 2</option>
      <option value="audio/morceau3.mp3">Morceau 3</option>
    </select>

    <button id="playPause">‚ñ∂Ô∏è Lecture</button>

    <div class="control-group">
      <div class="label-row">
        <span>Vitesse</span>
        <span id="speedValue">1.00√ó</span>
      </div>
      <input type="range" id="speed" min="0.5" max="2" step="0.05" value="1" />
    </div>

    <div class="control-group">
      <div class="label-row">
        <span>Hauteur</span>
        <span id="pitchValue">0 demi-ton</span>
      </div>
      <input type="range" id="pitch" min="-12" max="12" step="1" value="0" />
    </div>

    <footer>Pitch & Tempo 100% ind√©pendants ‚Äì Tone.js</footer>
  </div>

  <script>
    let player, pitchShift;
    let isPlaying = false;

    function loadTrack(url) {
      if (player) {
        player.dispose();
        pitchShift.dispose();
      }

      pitchShift = new Tone.PitchShift({ pitch: 0 }).toDestination();
      player = new Tone.Player(url).connect(pitchShift);
      player.playbackRate = 1;
    }

    loadTrack(document.getElementById("trackSelect").value);

    document.getElementById("trackSelect").addEventListener("change", e => {
      loadTrack(e.target.value);
    });

    document.getElementById("playPause").addEventListener("click", async () => {
      await Tone.start();

      if (!isPlaying) {
        player.start();
        isPlaying = true;
        document.getElementById("playPause").textContent = "‚è∏ Pause";
      } else {
        player.stop();
        isPlaying = false;
        document.getElementById("playPause").textContent = "‚ñ∂Ô∏è Lecture";
      }
    });

    document.getElementById("speed").addEventListener("input", e => {
      const v = parseFloat(e.target.value);
      player.playbackRate = v;
      document.getElementById("speedValue").textContent = v.toFixed(2) + "√ó";
    });

    document.getElementById("pitch").addEventListener("input", e => {
      const s = parseInt(e.target.value);
      pitchShift.pitch = s;
      document.getElementById("pitchValue").textContent =
        (s >= 0 ? "+" : "") + s + " demi-tons";
    });
  </script>
</body>
</html>
